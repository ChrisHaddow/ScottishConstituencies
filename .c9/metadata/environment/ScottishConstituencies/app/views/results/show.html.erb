{"changed":false,"filter":false,"title":"show.html.erb","tooltip":"/ScottishConstituencies/app/views/results/show.html.erb","value":"<style type=\"text/css\">\n      #mapDiv {\n        width: 600px;\n        height: 400px;\n      }\n    </style>\n    \n    <div id=\"mapDiv\"></div>\n<p>\n  <strong>Ons code:</strong>\n  <%= @result.ons_code %>\n</p>\n\n<p>\n  <strong>Constituency:</strong>\n  <%= @result.constituency %>\n</p>\n\n<p>\n  <strong>Region:</strong>\n  <%= @result.region %>\n</p>\n\n<p>\n  <strong>Election date:</strong>\n  <%= @result.election_date %>\n</p>\n\n<p>\n  <strong>Electorate:</strong>\n  <%= @result.electorate %>\n</p>\n\n<p>\n  <strong>Total ballot:</strong>\n  <%= @result.total_ballot %>\n</p>\n\n<p>\n  <strong>Total valid:</strong>\n  <%= @result.total_valid %>\n</p>\n\n<p>\n  <strong>Rejected ballot:</strong>\n  <%= @result.rejected_ballot %>\n</p>\n\n<p>\n  <strong>Turnout:</strong>\n  <%= @result.turnout %>\n</p>\n\n<p>\n  <strong>Rejected ballot percent:</strong>\n  <%= @result.rejected_ballot_percent %>\n</p>\n\n<p>\n  <strong>Con:</strong>\n  <%= @result.con %>\n</p>\n\n<p>\n  <strong>Lab:</strong>\n  <%= @result.lab %>\n</p>\n\n<p>\n  <strong>Lib:</strong>\n  <%= @result.lib %>\n</p>\n\n<p>\n  <strong>Snp:</strong>\n  <%= @result.snp %>\n</p>\n\n<p>\n  <strong>Ind:</strong>\n  <%= @result.ind %>\n</p>\n\n<p>\n  <strong>Tusc:</strong>\n  <%= @result.tusc %>\n</p>\n\n<p>\n  <strong>Grn:</strong>\n  <%= @result.grn %>\n</p>\n\n<p>\n  <strong>Other:</strong>\n  <%= @result.other %>\n</p>\n\n<p>\n  <strong>Con percent:</strong>\n  <%= @result.con_percent %>\n</p>\n\n<p>\n  <strong>Lab percent:</strong>\n  <%= @result.lab_percent %>\n</p>\n\n<p>\n  <strong>Lib percent:</strong>\n  <%= @result.lib_percent %>\n</p>\n\n<p>\n  <strong>Snp percent:</strong>\n  <%= @result.snp_percent %>\n</p>\n\n<p>\n  <strong>Ind percent:</strong>\n  <%= @result.ind_percent %>\n</p>\n\n<p>\n  <strong>Tusc percent:</strong>\n  <%= @result.tusc_percent %>\n</p>\n\n<p>\n  <strong>Grn percent:</strong>\n  <%= @result.grn_percent %>\n</p>\n\n<p>\n  <strong>Other percent:</strong>\n  <%= @result.other_percent %>\n</p>\n\n<p>\n  <strong>Win:</strong>\n  <%= @result.win %>\n</p>\n\n<p>\n  <strong>Second:</strong>\n  <%= @result.second %>\n</p>\n\n<%= link_to 'Edit', edit_result_path(@result) %> |\n<%= link_to 'Back', results_path %>\n\n<script>\nvar map;\nfunction initMap() {\n  map = new google.maps.Map(document.getElementById('mapDiv'), {\n    zoom: 10,\n   \n  });\n  \n\nvar json = <%= raw @results.to_json %>\n\n\n\nfunction getResultsID(constituencyID){\n  for(var i = 0; i < json.length; i++) {\n    var obj = json[i];\n      if (obj.ons_code == constituencyID){\n        return obj.id\n      }\n  }\n}\n\nfunction getWinnerColour(constituencyID){\n  for(var i = 0; i < json.length; i++) {\n    var obj = json[i];\n    if (obj.ons_code == constituencyID){\n      switch(obj.win) {\n         case \"SNP\":\n           return \"yellow\"\n           break;\n         case \"Con\":\n           return \"blue\"\n           break;\n         case \"LD\":\n           return \"orange\"\n           break;\n         case \"Lab\":\n           return \"red\"\n           break;\n           \n         default:\n           return \"white\"\n      }\n    }\n  }\n  \n}\n\n  map.data.loadGeoJson('/Scottish_Parliamentary_Constituencies_May_2016_Generalised_Clipped_Boundaries_in_Scotland.json');\n  \n   \n   \n  var bounds = new google.maps.LatLngBounds();\n  \n  setTimeout(function() {\n  map.data.forEach(function(feature){\n    \n    if(feature.getProperty('spc16cd') === \"<%= raw @result.ons_code %>\"){\n      feature.getGeometry().forEachLatLng(function(latlng){\n        bounds.extend(latlng);\n      });\n      \n    } \n    \n  });\n    map.fitBounds(bounds);\n  //map.setCenter(bounds.getCenter());\n  }, 500); \n  \n  \n  \n  \n  map.data.setStyle(function(feature) {\n    \n    //alert(json)\n    var constituencyID = feature.getProperty('spc16cd');\n    var winnerColour =  getWinnerColour(constituencyID);\n    //alert(winnerColour)\n    return{\n      fillColor: winnerColour,\n      strokeWeight: 1\n      }\n\n  });\n  \n  map.data.addListener('click', function(event) {\n   //map.data.overrideStyle(event.feature, {fillColor: 'red'});\n   //window.location.href = \"http://www.google.co.uk\";\n   var constituencyID = event.feature.getProperty('spc16cd');\n   //var shape = \"\";\n   //event.feature.getGeometry().forEachLatLng(function(latlng){\n        //shape += latlng\n   // });\n   var resultsID = getResultsID(constituencyID);\n   var constituencyID = event.feature.getProperty('spc16cd');\n   \n\n   //alert(\"/results/\" + resultsID);\n   window.location.href = \"/results/\" + resultsID;\n   \n  });\n  \n  \n} \n</script>\n\n<script\n      async\n      defer\n      src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDhKyQWFivojfdUqLP1r_4wG-cMQke-G7o&callback=initMap\">\n</script>\n\n","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":2695.333251953125,"scrollleft":0,"selection":{"start":{"row":155,"column":12},"end":{"row":155,"column":12},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1582635973472}